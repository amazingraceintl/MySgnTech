* @ValidationCode : MjoxMzk0MTgxMTU0OkNwMTI1MjoxNzA2ODU5ODIxMTY1OlBldGVyOi0xOi0xOjA6MDpmYWxzZTpOL0E6UjIyX1NQOS4wOi0xOi0x
* @ValidationInfo : Timestamp         : 02 Feb 2024 08:43:41
* @ValidationInfo : Encoding          : Cp1252
* @ValidationInfo : User Name         : Peter
* @ValidationInfo : Nb tests success  : N/A
* @ValidationInfo : Nb tests failure  : N/A
* @ValidationInfo : Rating            : N/A
* @ValidationInfo : Coverage          : N/A
* @ValidationInfo : Strict flag       : N/A
* @ValidationInfo : Bypass GateKeeper : false
* @ValidationInfo : Compiler Version  : R22_SP9.0
* @ValidationInfo : Copyright Temenos Headquarters SA 1993-2021. All rights reserved.
$PACKAGE PR.AJAYI
SUBROUTINE EM.LOAN.TESTER
*-----------------------------------------------------------------------------
*
*-----------------------------------------------------------------------------
* Modification History :
*-----------------------------------------------------------------------------

*-----------------------------------------------------------------------------

    $USING EB.SystemTables
    $USING EM.LoanOrigination
    $USING EB.DataAccess

    GOSUB Init
    
RETURN


Init:
    CreditSubjectIdArr = EB.SystemTables.getRNew(EM.LoanOrigination.LoApplication.CcSubjectId)
    CreditOption  = EB.SystemTables.getRNew(EM.LoanOrigination.LoApplication.CcOption)
    LoanApplId = EB.SystemTables.getIdNew()
    
    Cred.Subj.Cnt = DCOUNT(CreditSubjectIdArr,@VM)
    
    FOR i = 1 TO Cred.Subj.Cnt
        CurrCredOption = FIELD(CreditOption,@VM, i)
        IF CurrCredOption = 'YES' THEN
            IF i EQ 1 THEN
                Repo<-1> = 20
            END ELSE
                Repo<-1> = 40
            END
            GOSUB WriteCrChkActivity
        END
    NEXT i
RETURN

WriteCrChkActivity:
    FOR ii = 1 TO Cred.Subj.Cnt
        EB.SystemTables.setRNew(EM.LoanOrigination.LoApplication.CcResultId, Repo<ii>)<1,ii>
    NEXT ii
    
    Y.OUT.VALUE = EB.SystemTables.getRNew(Y.FLD)<1,Y.MFLD,Y.SFLD>
RETURN
END
